# Grievous
    General Grievous :)

    An EDA simulator wrapper script of Cadence Xcelium, Synopsys VCS, etc.
    Use one line command to call different digital simulators in short.
    An example is to start a simulation with a command like 'grievous -t test0'.

    Follow MIT license.

    Nowadays, in digital design and verification team of an integrated circuit (IC) company, a common script of invoking different simulators is used normally.
    The script is based on perl, python or makefile in different companies.

    The scirpt in this repo is programmed by python3.
    With the help of some configuration text files and global variables, the script creates simulation folders, compile scripts, and simulate scripts, then runs them automatically.
    Different engineers are easily to share and debug simulation results in the team, and easily to reproduce a failed simulation if they are using the same script.

    Both single simulation and regression are supported.
    Coverage is also collected in need, and the curve of coverage percentage of daily regression is generated by calling gnuplot by the script.

    Support to sumbit jobs to LSF system or current host.

    Support UVM testbench and verilog-only testbench.
    For verification engineers, an UVM based simulation environment is easily to be build by the script.
    For design engineers who are not familiar with UVM, a verilog or systemverilog based simulation environment is also supported by it.

    TBA

# Usage, arguments
| Argument | Description |
| - | - |
| --debug | Print more message. `For debug only.` |
| -h | Print help message of the script. `Without start a simulation.` |
| -t [test_name] | Specify the name of a test. `It's used to find a file which name is [test_name].sv, and the [test_name] is passed to simulatior as +UVM_TESTNAME=[test_name]. So, make sure the file name and uvm_test name are same with [test_name]. Specify more than one test will start a regression. For example, '-t test0 -t test1' is workable.` |
| -r [regression_list_file] | Sepcify a file of regression test list. `See an example file in below.` |
| -g [regression_group_name] | Sepcify a group name in regression list file. `More than one group can be selected. For example, using '-g A -g B' in the same command line will select two groups in the list.` |
| -uvm | Enable the compilation of UVM packages. `By default, UVM packages are compiled.` |
| -nouvm | Disable the compilation of UVM packages. |
| -c | Clean existing simulation folder. `Without this arguments, the compile stage keeps incremental compilation if simulation folder is reused.` |
| -s [seed] | Specify the seed of a simulation. `The seed will passed to simulators. If seed isn't specified, the script generates a random seed in background.` |
| -w [wave_type] | Dump signals to waveform files. `[wave_type] can be ommitted, the default waveform type of Cadence Xceilum is .shm, and the default type of Synopsys VCS is fsdb. Wave type can also be specified in command line, it supports [-w shm, -w vcd, -w fsdb, -w vpd] for now. The signals and hierachies are specified in a user-defined file.` |
| -wall [wave_type] | Dump all signals in all hierachy into waveform files. |
| -atm | Print extra message in simulation. `Extra message includs folder name, command and system time. It's useful infomation when the simulation runs for days, weeks, or even months.` |
| -noatm | Disable extra message printed. `Note that the extra message is enabled by default in a single simulation.` |
| -input [tcl_file] | Specify a tcl file and pass it to simulator. `Pass to Cadence Xcelium: 'xrun -input [tcl_file] ...'` |
| -b [block_name] | Specify block name for block level verification. `Do NOT use this argument if it's a TOP level verification. The [block_name] should be the folder name of a block level design.` |
| -dv[\d*] | Means -dv, -dv0, -dv1, or -dv2..., specify another dv folder as default. `If the dv folder name is 'dv', -dv can be ommitted.` |
| -localdv[\d*] | Means -localdv, -localdv0, -localdv1, or -localdv2..., specify another dv folder as default. `LocalDV is a temprary DV environment, which is assumed to be a non-UVM environment which is used by design engineers.` |
| -rtl | Pre simulation with RTL only. `By default, it's a pre simulation.` |
| -gate | Post simulation with gate level netlist. |
| -fpga | Simualtion for FPGA use. |
| -cosim | `Not support yet.` |
| -fault | `Not support yet.` |
| -tfile [tfile] | Specify timing file '.tfile'. `Multiple tfile files can be specified by calling '-tfile [tfile]' multiple times.` |
| -lsf | Calling 'bsub'. `By default, bsub is called. But if LSF is not installed, use '-nolsf' in command line.` |
| -nolsf | Do not call 'bsub'. |
| -interactivelsf | Calling 'bsub -I' for interactive mode of LSF. |
| -nointeractivelsf | Do not use '-I' of bsub command. `By default, a single simulation use 'bsub -I ...' to submit job to LSF.` |
| -jname [job_queue_name] | Specify job queue name of bjobs. |
| -rcn [number] | Specify compile repeat times. `If compile fails, the script re-compiles database, by default, by 3 times.` |
| -sim_root [folder_path] | Specify a folder that all the simulation folders are created under that folder. `By default, the folder is defined in global variable 'SIM_ROOT'.` |
| -d [folder_path] | Specify a folder to run simulation, instead of creating one automatically. |
| -repeat [number] | Run a simulation or regression for [number] times. `For example, to run a test for 10 times, use 'grievous -t test0 -repeat 10'.` |
| -append [string] | For generated folder, its name is the test name. In order to distinguish the test from another run, append something to the folder name. `For example: [test_name]_[string] is the new name of simulation folder.` |
| -setup [another_config_file] | Specify another configuration file, instead of using the default one 'sim.setup'. |
| -max [number] | Specify the maxium number of parallel running jobs in regression. `By default, the max number is 10. It's useful in regression when computer resoure is limited.` |
| -qc [number] | Simulation quits when the count of error is larger than [number]. |
| -m [host_name] | Specify the host or hosts where the jobs are submitted in LSF. |
| -inf | `Not support yet.` |
| -ext_lsf_opt "string" | Pass some options to bsub from command line. `Users can also specify options to bsub from configuration files.` |
| -ext_comp_opt "string" | Pass some options to simulator at compilation stage. `Users can also specify options to bsub from configuration files.` |
| -ext_sim_opt "string" | Pass some options to simulator at simulation stage. `Users can also specify options to bsub from configuration files.` |
| -ext_dbg_opt "string" | Pass some options to Cadence Simvision, Synopsys Verdi. `Users can also specify options to bsub from configuration files.` |
| -ext_opt "string" | Pass some options to simulators, at both compilation and simulation stages. `Users can also specify options to bsub from configuration files.` |
| -co | Compile but not simulate. |
| -gs | Generate simulation folder and scripts, but do NOT start compile and simulate. |
| -cov | Enable coverage collection. |
| -cm | For regression, merge the coverage of every tests together. |
| -nocov | Disable coverage collection, higher priority than '-cov'. |
| -refine [refine_file_name] | Specify refine file used in coverage collection and merge. |
| -gui | Run simulation in gui mode. |
| -nc | Use Cadence Xcelium as the simulator. `The default simulator is set to Xcelium.` |
| -vcs | Use Synopsys VCS as the simulator. |
| -simtmp | For Cadence Xcelium, a user-defined folder can be set as simulation intermedia folder. `See more details in user guide of Xcelium.` |
| +[options] | Any options with leading '+' will be passed to simulator directly. |
| -[custom_switch] [value] | Enable a custom switch, and give a value of it. `[value] is not necessary.` |
| --[custom_switch] | Disable a custom switch. `If a custom swithc is default on in configuration file. It's also can be disabled from command line.` |

    TBA

# Configuration files
    The default name is configuration file is 'sim.setup'.

    For block level or top level verification, a default 'sim.setup' should be created in this rule:

    TBA

# Global variables

    TBA

# Custom switch

    TBA

# Regression list file example

    TBA

# Folder structure

    TBA

# Features by now and in future

    TBA
